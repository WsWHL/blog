{% extends "web/base/base.html" %}
{% block title %}博客编辑{% endblock %}
{% block style %}
<link rel="stylesheet" href="/static/css/editormd.min.css" />
<style type="text/css">
    #title{
        width: 60%;
        border: none;
        outline: medium;
        text-align: center;
        border-bottom: 1px solid #000000;
        margin: 10px auto 20px auto;
        box-shadow: none;
        -webkit-box-shadow:none;
    }
</style>
{% endblock %}
{% block content %}
    {% include 'web/base/header.html' %}
    <br>
    <div class="grid-container" style="min-height:600px;">
        <div class="grid-x grid-margin-x">
            <div class="cell small-12 medium-10 large-10 medium-offset-1 large-offset-1" style="background-color: #fff;padding:20px;">
                <form action="#" method="post" enctype="multipart/form-data" data-abide novalidate>
                    {% csrf_token %}
                    <div class="column">
                        <label>
                            <input id="title" name="title" type="text" align="middle" autofocus="autofocus" minlength="10"
                                   maxlength="100" placeholder="标题，至少8个字符" autocomplete="off"
                                   required value="{{ article.title.value }}">
                            <span class="form-error">请输入文章标题！</span>
                        </label>
                    </div>
                    <div class="column">
                        <ul class="vertical menu" data-accordion-menu>
                            <li>
                                <a href="#">简要信息</a>
                                <ul class="menu vertical nested">
                                    <li>
                                        <input name="subject" type="text" maxlength="500" placeholder="主题内容"
                                               value="{{ article.subject.value }}">
                                    </li>
                                </ul>
                            </li>
                        </ul>
                    </div>
                    {% if categories %}
                        <br>
                        <div class="column">
                            <fieldset>
                                <legend>分类：</legend>
                                {% for category in  categories %}
                                    <input id="{{ category.spell }}" name="categories" type="checkbox"
                                           value="{{ category.id }}" {{ category.checked }}>
                                    <label for="{{ category.spell }}">{{ category.name }}</label>
                                {% endfor %}
                            </fieldset>
                        </div>
                    {% endif %}
                    <div class="column">
                    <div id="editor">
                    <textarea style="display:none;">{{ article.content.value }}</textarea>
                    </div>
                    </div>
                    <br>
                    <div class="column">
                        <p>置顶：</p>
                        <div class="switch medium">
                            {% if article.topping.value %}
                                <input class="switch-input" id="topping" name="topping" type="checkbox"
                                       onclick="this.value=this.checked?1:0" checked>
                            {% else %}
                                <input class="switch-input" id="topping" name="topping" type="checkbox"
                                       onclick="this.value=this.checked?1:0">
                            {% endif %}
                            <label class="switch-paddle" for="topping">
                                <span class="show-for-sr">是否置顶？</span>
                                <span class="switch-active" aria-hidden="true">是</span>
                                <span class="switch-inactive" aria-hidden="true">否</span>
                            </label>
                        </div>
                    </div>
                    <br>
                    <div class="column text-left">
                        <button type="submit" class="button">提交</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
{% endblock %}

{% block script %}
    <script type="text/javascript" src="/static/js/editormd.min.js"></script>
    <script type="text/javascript" src="/static/js/languages/zh-tw.js"></script>
    <script type="text/javascript">
        $(function(){
            var editor = editormd('editor', {
                name:'content',
                width:'100%',
                height:800,
                placeholder:'请编写你的文章内容.',
                codeFold:true,
                watch:false,
                toolbarAutoFixed:true,
                emoji:true,
                tex:true,
                imageUpload:true,
                imageFormats:["jpg", "jpeg", "gif", "png", "bmp", "webp"],
                imageUploadURL:'/upload/',
                csrftoken: document.getElementsByName('csrfmiddlewaretoken')[0].value,
                crossDomainUploadz:true,
                uploadCallbackURL:'',
                fileName: 'file',
                path:'/static/lib/',
                pluginPath:'/static/js/plugins/',
                lang:{
                    lang:'zh-tw'
                },
                onfullscreen: function(){
                    $('.switch').hide();
                },
                onfullscreenExit: function(){
                    $('.switch').show();
                }
            });
        });
    </script>
{% endblock %}
